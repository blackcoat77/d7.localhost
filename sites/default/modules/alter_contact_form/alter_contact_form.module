<?php

/**
 * @file alter_contact_form
 * 
 * This module alter and adds additional form field phone to contact form and alters hook_mail() to send
 * phone numbers to the user
 */

//function alter_contact_form_form_alter(&$form, &$form_state, $form_id) {
//  dsm($form_id);  // print form ID to messages
//  dsm($form);  // pretty print array using Krumo to messages
//}

/**
 * Implements hook_form_FORM_ID_alter().
 * @see https://api.drupal.org/api/drupal/modules!system!system.api.php/function/hook_form_FORM_ID_alter/7
 * @see tuts: http://willvincent.com/blog/adding-one-or-more-fields-drupal-7-contact-form
 * Adds new phone custom fields to the drupal default contact form
 */
function alter_contact_form_form_contact_site_form_alter(&$form, &$form_state)  {
    // add a phone number field to the contact form
    $form['phone'] = array(
        '#title' => t('Your phone number'),
        '#type' => 'textfield',
        '#maxlength' => 20,
        '#required' => TRUE,
    );
    
    $order = array('name', 'mail', 'phone', 'subject', 'cid', 'message', 'copy', 'submit');
    
    // Order the elements by changing their #weight property.
    foreach($order as $key => $field) {
    $form[$field]['#weight'] = $key;
  }
}

/**
 * Implements hook_mail_alter()
 * @see https://api.drupal.org/api/drupal/modules%21system%21system.api.php/function/hook_mail_alter/7
 */
function alter_contact_form_mail_alter(&$message)  {
   // We only want to alter the email if it's being
  // generated by the site-wide contact form page.
  if ($message['id'] == 'contact_page_mail') {
    $message['body'][] = t('Phone') . ' : ' . $message['params']['phone'];
  }
}